<div class="px-5">
  <h1 class="text-secondary">Preservation Dashboard - option 4</h1>
  <nav>
    <ul class="nav nav-tabs" id="dashboardTab">
      <li class="nav-item dropdown" id="catalogTab">
        <div class="nav-link dropdown-toggle active" data-bs-toggle="dropdown" role="button" aria-expanded="false">
          Catalog Status&nbsp;&nbsp;
          <span class="badge rounded-pill <%= catalog_ok? && !any_complete_moab_errors? ? 'bg-success' : 'bg-danger' %>">
            <%= catalog_ok? && !any_complete_moab_errors? ? 'OK' : 'Error' %>
          </span>
        </div>
        <ul class="dropdown-menu">
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#catalog-tab-pane" role="tab" data-bs-toggle="tab">
            Object and Version Counts&nbsp;&nbsp;
            <span class="badge rounded-pill <%= catalog_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= catalog_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#catalog-tab-pane" role="tab" data-bs-toggle="tab">
            CompleteMoab Statuses
            <span class="badge rounded-pill <%= any_complete_moab_errors? ? 'bg-danger' : 'bg-success' %>">
              <%= any_complete_moab_errors? ? 'Error' : 'OK' %>
            </span>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" role="tab" data-bs-toggle="tab">
            Validate Moab Audit
            <span class="badge rounded-pill <%= validate_moab_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= validate_moab_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" role="tab" data-bs-toggle="tab">
            Moab to Catalog Audit
            <span class="badge rounded-pill <%= moab_to_catalog_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= moab_to_catalog_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" role="tab" data-bs-toggle="tab">
            Catalog to Moab Audit
            <span class="badge rounded-pill <%= catalog_to_moab_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= catalog_to_moab_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" role="tab" data-bs-toggle="tab">
            Checksum Validation Audit&nbsp;&nbsp;
            <span class="badge rounded-pill <%= checksum_validation_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= checksum_validation_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="nav-link dropdown-item" style="color:var(--bs-link-color)" href="resque">Redis queues</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown" id="replicationTab">
        <div class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false">
          Replication Status&nbsp;&nbsp;
          <span class="badge rounded-pill <%= zip_parts_ok? && replication_ok? ? 'bg-success' : 'bg-danger' %>">
            <%= zip_parts_ok? && replication_ok? ? 'OK' : 'Error' %>
          </span>
        </div>
        <ul class="dropdown-menu">
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#replication-tab-pane" data-bs-toggle="tab">
            ZipPart Statuses
            <span class="badge rounded-pill <%= zip_parts_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= zip_parts_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <% endpoint_data.each do |endpoint_name, endpoint_info| %>
            <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#replication-tab-pane" data-bs-toggle="tab">
              <span class="text-secondary">Endpoint: </span><%= endpoint_name %>&nbsp;&nbsp;
              <% replication_count = endpoint_info[:replication_count] %>
              <% endpoint_replication_ok = replication_count == num_object_versions_per_preserved_object %>
              <span class="badge rounded-pill <%= endpoint_replication_ok ? 'bg-success' : 'bg-danger' %>">
                <%= endpoint_replication_ok ? 'OK' : 'Error' %>
              </span>
            </li>
          <% end %>
          <li><hr class="dropdown-divider"></li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            Catalog to Archive Audit&nbsp;&nbsp;
            <span class="badge rounded-pill <%= catalog_to_archive_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= catalog_to_archive_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" style="color:var(--bs-link-color)" href="resque">Redis queues</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown" id="auditTab">
        <div class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false">
          Audit Status&nbsp;&nbsp;
          <span class="badge rounded-pill <%= audits_ok? ? 'bg-success' : 'bg-danger' %>">
            <%= audits_ok? ? 'OK' : 'Error' %>
          </span>
        </div>
        <ul class="dropdown-menu">
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            <span class="d-flex justify-content-start">
              <span class="text-secondary">Catalog&nbsp;&nbsp;</span>
              Validate Moab
            </span>
            <span class="badge rounded-pill <%= validate_moab_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= validate_moab_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            <span class="d-flex justify-content-start">
              <span class="text-secondary">Catalog&nbsp;&nbsp;</span>
              Moab to Catalog
            </span>
            <span class="badge rounded-pill <%= moab_to_catalog_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= moab_to_catalog_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            <span class="d-flex justify-content-start">
              <span class="text-secondary">Catalog&nbsp;&nbsp;</span>
              Catalog to Moab
            </span>
            <span class="badge rounded-pill <%= catalog_to_moab_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= catalog_to_moab_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            <span class="d-flex justify-content-start">
              <span class="text-secondary">Catalog&nbsp;&nbsp;</span>
              Checksum Validation&nbsp;&nbsp;
            </span>
            <span class="badge rounded-pill <%= checksum_validation_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= checksum_validation_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li class="nav-link dropdown-item d-flex justify-content-between" data-bs-target="#audit-tab-pane" data-bs-toggle="tab">
            <span class="d-flex justify-content-start">
              <span class="text-secondary">Replication&nbsp;&nbsp;</span>
              Catalog to Archive&nbsp;&nbsp;
            </span>
            <span class="badge rounded-pill <%= catalog_to_archive_audit_ok? ? 'bg-success' : 'bg-danger' %>">
              <%= catalog_to_archive_audit_ok? ? 'OK' : 'Error' %>
            </span>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" style="color:var(--bs-link-color)" href="resque">Redis queues</a></li>
        </ul>
      </li>
    </ul>
  </nav>
  <div class="tab-content" id="dashboardTabContent">
    <div class="tab-pane fade show active" id="catalog-tab-pane" role="tabpanel" aria-labelledby="catalog-tab" tabindex="0">
      <turbo-frame id="catalog_information">
        <%= render partial: 'catalog_information' %>
      </turbo-frame>
    </div>
    <div class="tab-pane fade" id="replication-tab-pane" role="tabpanel" aria-labelledby="replication-tab" tabindex="0">
      <turbo-frame id="replication_information">
        <%= render partial: 'replication_information' %>
      </turbo-frame>
    </div>
    <div class="tab-pane fade" id="audit-tab-pane" role="tabpanel" aria-labelledby="audit-tab" tabindex="0">
      <turbo-frame id="audit_information">
        <%= render partial: 'audit_information' %>
      </turbo-frame>
    </div>
  </div>
</div>